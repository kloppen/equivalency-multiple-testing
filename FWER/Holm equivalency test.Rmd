---
title: "Sample Code for Incorporating Holm's Procedure in the Equivalency Test"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Introduction to the Simulation Study

This R Markdown document contains sample code for performing simulation
studies related to Holm's method for strong control of the Type I error
rate in the equivalency test.

In these simulation studies we consider the case of the qualification
and equivalency samples, with $18$ units of analysis in the
qualification sample and either $6$ or $8$ units of analysis in the
equivalency sample. The outcome vectors for the units of analysis within
a particular group are independently generated from a single
Multivariate Normal distribution. The mean vectors for the Multivariate
Normal distributions of the two groups differ. The two Multivariate
Normal distributions will have the same covariance matrix in this
setting. The outcomes for a single unit of analysis may have be
correlated depending on the covariance matrix that is entered in the
simulation study.

To summarize, if we let $\mathbf{y}_{i,j}$ denote the vector of $k$
outcomes for unit $i = 1, \ldots, n$ in group $j = 1, 2$, then we assume
that
$$\mathbf{y}_{i,j} \sim \mathrm{N}_k(\mathbf{\mu}_j, \mathbf{\Sigma})$$
independently.

For PMC materials we consider $10$ endpoints, and for AM materials we
consider $20$ or $30$ endpoints.

```{r}
#devtools::install_github("cmstatr/cmstatrExt")

library(tidyverse)
library(furrr)
library(cmstatr)
library(pwr)
library(cmstatrExt)

plan(multisession, workers = 12)
```

```{r}

# Essential functions

generate_data = function(number_observations, mu_vector, covariance_matrix)
{
  chol_covariance_matrix = chol(covariance_matrix)
  
  random_normal = matrix(rnorm((number_observations*length(mu_vector))), 
                         ncol=number_observations, nrow=length(mu_vector))
  
  outcomes = t(chol_covariance_matrix)%*%random_normal + 
             matrix(rep(mu_vector, number_observations), 
                    ncol=number_observations, nrow=length(mu_vector))
  
  return(t(outcomes))
}

calculate_FWE_FDR_TDR = function(number_data_sets = 1e3,
                                 nominal_significance_level = 0.05,
                                 number_endpoints = 10,
                                 number_group_1 = 18, number_group_2 = 6, 
                                 mu_1 = rep(0, number_endpoints),
                                 mu_2 = rep(0, number_endpoints),
                                 sigma_vector = rep(1, number_endpoints), 
                                 rho = 0.5)
{
  # The number of outcomes is denoted by number_endpoints
  
  # The total number of observations across the two groups is denoted by 
  # total_number_observations
  
  # The number of observations in group 1 (the qualification sample) is 
  # number_group_1 
  
  # Group 2 corresponds to the equivalency sample
  
  # The mu vectors for the two groups are denoted by mu_1 and mu_2, respectively
  
  # For simplicity, here we consider the case of being given a vector of 
  # standard deviations for the different outcomes (sigma_vector), 
  # and that the different outcomes have a constant correlation parameter (rho)
  
  # The entries for which the null hypothesis of the endpoints is "false" are 
  # denoted by active_endpoint_indicator
  
  active_endpoint_indicator = as.numeric(mu_1-mu_2!=0)
  
  # false_rejections = rep(0, number_data_sets)
  # FWER = rep(0, number_data_sets)
  # FDR = rep(0, number_data_sets)
  # TDR = rep(0, number_data_sets)
  
  covariance_matrix = diag(sigma_vector^2)
  for(i in 1:(number_endpoints-1))
  {
    for(j in (i+1):number_endpoints)
    {
      covariance_matrix[i,j] = rho*sigma_vector[i]*sigma_vector[j]
    }
  }
  
  covariance_matrix = t(covariance_matrix) + covariance_matrix - 
                      diag(sigma_vector^2)
  
  repeat_iterations = function(i)
  {
    new_group_1 = generate_data(number_group_1, mu_1, covariance_matrix)
    new_group_2 = generate_data(number_group_2, mu_2, covariance_matrix)

    p_values <- map_dbl(
      (1:number_endpoints),
      function(x)
      {
        t1 = (mean(new_group_1[,x]) - min(new_group_2[,x]))/
          sd(new_group_1[,x])
        t2 = (mean(new_group_1[,x]) - mean(new_group_2[,x]))/
          sd(new_group_1[,x])
        return(cmstatrExt::p_equiv_two_sample(length(new_group_1[,x]),
                                              length(new_group_2[,x]), t1, t2))
      }
    )
    
    endpoint_indicator = (1:number_endpoints)[order(p_values)]    
    active_endpoint_indicator = active_endpoint_indicator[order(p_values)]
    ordered_p_values = p_values[order(p_values)]
    holm_significance_levels = nominal_significance_level/
                               (number_endpoints+1-1:number_endpoints)
    rejection_indicators = as.numeric(ordered_p_values<=
                                      holm_significance_levels)
    
    if(sum(rejection_indicators)==0)
    {
      # false_rejections[i]<<-0
      # FWER[i]<<-0
      # FDR[i]<<-0
      # TDR[i]<<-0
      return(tibble(
        false_rejections = 0,
        FWER = 0,
        FDR = 0,
        TDR = 0
      ))
    }
    
    if(sum(rejection_indicators)>0)
    {
      if(length((1:length(rejection_indicators))[rejection_indicators==0])==0)
      {
        # false_rejections[i]<<-number_endpoints-
        #                       sum(active_endpoint_indicator==1)
        # FWER[i]<<-as.numeric(false_rejections[i]>0)
        # FDR[i]<<-false_rejections[i]/sum(rejection_indicators)
        # TDR[i]<<-sum(active_endpoint_indicator==1)/sum(rejection_indicators)
        false_rejections <- number_endpoints-
          sum(active_endpoint_indicator==1)
        FWER <- as.numeric(false_rejections>0)
        FDR <- false_rejections/sum(rejection_indicators)
        TDR <- sum(active_endpoint_indicator==1)/sum(rejection_indicators)
        
        return(tibble(
          false_rejections = false_rejections,
          FWER = FWER,
          FDR = FDR,
          TDR = TDR
        ))
      }
      
      if(length((1:length(rejection_indicators))[rejection_indicators==0])>0)
      {
        first_failure_to_reject_indicator =
          min((1:length(rejection_indicators))[rejection_indicators==0])
        
        # false_rejections[i]<<-sum(active_endpoint_indicator[1:(first_failure_to_reject_indicator-1)]==0)
        # FWER[i]<<-as.numeric(false_rejections[i]>0)
        # FDR[i]<<-false_rejections[i]/sum(rejection_indicators)
        # TDR[i]<<-sum(active_endpoint_indicator[1:(first_failure_to_reject_indicator-1)]==1)/
        #          sum(rejection_indicators)
        false_rejections <- sum(active_endpoint_indicator[1:(first_failure_to_reject_indicator-1)]==0)
        FWER <- as.numeric(false_rejections>0)
        FDR <- false_rejections/sum(rejection_indicators)
        TDR <- sum(active_endpoint_indicator[1:(first_failure_to_reject_indicator-1)]==1)/
          sum(rejection_indicators)
        return(tibble(
          false_rejections = false_rejections,
          FWER = FWER,
          FDR = FDR,
          TDR = TDR
        ))
      }
    }
  }
  # 
  # repeat_the_iterations = sapply(1:number_data_sets, 
  #                                function(x)
  #                                {
  #                                  repeat_iterations(x)
  #                                  cat(x, fill=TRUE)
  #                                })
  
  res <- future_map_dfr(
    1:number_data_sets,
    repeat_iterations,
    .options = furrr_options(seed = 123456),
    .progress = TRUE
  )
  # 
  # Type_I_FWE = sum(FWER)/number_data_sets
  # mean_FDR = mean(FDR)
  # mean_TDR = mean(TDR)
  
  res %>% 
    summarise(
      Type_I_FWE = sum(FWER) / number_data_sets,
      mean_FDR = mean(FDR),
      mean_TDR = mean(TDR)
    )
  
  # return(c(Type_I_FWE, mean_FDR, mean_TDR))
}


# library("tictoc")
# 
# mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))
# 
# rho = 0.2
# 
# tic()
# calculate_FWE_FDR_TDR (10, nominal_significance_level = 0.05,
#                        10, number_group_1 = 18, number_group_2 = 8, 
#                        mu_1, mu_2, sigma_vector, rho)
# toc()
```

## 2. The Case of PMC Materials

### 2.a. Equivalency Sample Size = 6

#### 2.a.i. Active/Total Endpoints = 2/10, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 10
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)

```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.ii. Active/Total Endpoints = 2/10, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(0.5,0.5,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.iii. Active/Total Endpoints = 2/10, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(1,1,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.iv. Active/Total Endpoints = 5/10, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 10
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.v. Active/Total Endpoints = 5/10, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.vi. Active/Total Endpoints = 5/10, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.vii. Active/Total Endpoints = 8/10, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 10
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.viii. Active/Total Endpoints = 8/10, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.a.ix. Active/Total Endpoints = 8/10, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

### 2.b. Equivalency Sample Size = 8

#### 2.b.i. Active/Total Endpoints = 2/10, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 10
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.ii. Active/Total Endpoints = 2/10, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(0.5,0.5,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.iii. Active/Total Endpoints = 2/10, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(1,1,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.iv. Active/Total Endpoints = 5/10, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 10
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.v. Active/Total Endpoints = 5/10, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.vi. Active/Total Endpoints = 5/10, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.vii. Active/Total Endpoints = 8/10, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 10
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.viii. Active/Total Endpoints = 8/10, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 2.b.ix. Active/Total Endpoints = 8/10, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

## 3. The Case of AM Materials With 20 Total Endpoints

### 3.a. Equivalency Sample Size = 6

#### 3.a.i. Active/Total Endpoints = 2/20, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 20
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.ii. Active/Total Endpoints = 2/20, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(0.5,0.5,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.iii. Active/Total Endpoints = 2/20, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(1,1,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.iv. Active/Total Endpoints = 5/20, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 20
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.v. Active/Total Endpoints = 5/20, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.vi. Active/Total Endpoints = 5/20, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.vii. Active/Total Endpoints = 8/20, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 20
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.viii. Active/Total Endpoints = 8/20, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.a.ix. Active/Total Endpoints = 8/20, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

### 3.b. Equivalency Sample Size = 8

#### 3.b.i. Active/Total Endpoints = 2/20, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 20
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.ii. Active/Total Endpoints = 2/20, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(0.5,0.5,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.iii. Active/Total Endpoints = 2/20, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(1,1,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.iv. Active/Total Endpoints = 5/20, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 20
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.v. Active/Total Endpoints = 5/20, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.vi. Active/Total Endpoints = 5/20, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.vii. Active/Total Endpoints = 8/20, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 20
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.viii. Active/Total Endpoints = 8/20, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 3.b.ix. Active/Total Endpoints = 8/20, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

## 4. The Case of AM Materials With 30 Total Endpoints

### 4.a. Equivalency Sample Size = 6

#### 4.a.i. Active/Total Endpoints = 2/30, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 30
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.ii. Active/Total Endpoints = 2/30, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(0.5,0.5,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.iii. Active/Total Endpoints = 2/30, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(1,1,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.iv. Active/Total Endpoints = 5/30, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 30
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.v. Active/Total Endpoints = 5/30, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.vi. Active/Total Endpoints = 5/30, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.vii. Active/Total Endpoints = 8/30, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 30
number_group_1 = 18
number_group_2 = 6
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.viii. Active/Total Endpoints = 8/30, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.a.ix. Active/Total Endpoints = 8/30, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

### 4.b. Equivalency Sample Size = 8

#### 4.b.i. Active/Total Endpoints = 2/30, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 30
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(0.2,0.2,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.ii. Active/Total Endpoints = 2/30, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(0.5,0.5,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.iii. Active/Total Endpoints = 2/30, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(1,1,rep(0, (number_endpoints-2)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.iv. Active/Total Endpoints = 5/30, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 30
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.v. Active/Total Endpoints = 5/30, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.vi. Active/Total Endpoints = 5/30, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,5),rep(0,(number_endpoints-5)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.vii. Active/Total Endpoints = 8/30, Effect Size = 0.2, $\rho = 0.2, 0.5, 0.8$

```{r}

number_data_sets = 1e3
number_endpoints = 30
number_group_1 = 18
number_group_2 = 8
mu_1 = rep(0, number_endpoints)
sigma_vector = rep(1, number_endpoints)
```

```{r}
mu_2 = c(rep(0.2,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.viii. Active/Total Endpoints = 8/30, Effect Size = 0.5, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(0.5,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

#### 4.b.ix. Active/Total Endpoints = 8/300, Effect Size = 1, $\rho = 0.2, 0.5, 0.8$

```{r}
mu_2 = c(rep(1,8),rep(0,(number_endpoints-8)))

rho = 0.2

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.5

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```

```{r}
rho = 0.8

calculate_FWE_FDR_TDR (number_data_sets, nominal_significance_level = 0.05,
                       number_endpoints, number_group_1, number_group_2, 
                       mu_1, mu_2, sigma_vector, rho)
```
